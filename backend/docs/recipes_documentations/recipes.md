# üìò Recipe API Documentation

This document describes how to use the Recipe API endpoint, which allows for creating new recipes and retrieving detailed recipe information, including associated ingredients.

## üìç Endpoints
### 1. **POST** `/recipes/`
- Creates a new recipe with the provided data.
- Requires the user to be authenticated (via Bearer token).
- The creator field is automatically assigned based on the logged-in user via Bearer token (JWT).

#### üîç Request Format
```json
{
  "name": "Veggie Omelette",
  "steps": [
    "Crack the eggs into a bowl and whisk them.",
    "Chop the vegetables finely.",
    "Heat oil in a pan, saut√© vegetables, then pour in eggs.",
    "Cook until set and fold the omelette in half."
  ],
  "prep_time": 8,
  "cook_time": 7,
  "meal_type": "breakfast",
  "ingredients": [
    {
      "ingredient_id": 4,
      "quantity": 3,
      "unit": "pcs"
    },
    {
      "ingredient_id": 5,
      "quantity": 0.5,
      "unit": "cup"
    },
    {
      "ingredient_id": 6,
      "quantity": 1,
      "unit": "pcs"
    }
  ]
}
```

- Must be provided:
  - `name`: The name of the recipe.
  - `steps`: The steps to prepare the recipe. (Rememinder: The steps should be in a list format, not a string. And can be empty string if the user not sure about the steps for now.)
  - `prep_time`: Preparation time in minutes.
  - `cook_time`: Cooking time in minutes.
  - `meal_type`: Type of meal (e.g., breakfast, lunch, dinner).
  - `ingredients`: List of ingredients with their IDs, quantities, and units.
- **Note**: The `ingredients` field should contain a list of objects, each with `ingredient_id`, `quantity`, and `unit`.
- The `creator` field is automatically set based on the authenticated user.
- The `id` field is automatically generated by the database.
- The `created_at`, `updated_at`, and `deleted_on` fields are managed by the database.
- The `deleted_on` field is set to `null` when the recipe is created.

#### üì¶ Response Format
```json
{
  "id": 12,
  "name": "Veggie Omelette",
  "steps": [
    "Crack the eggs into a bowl and whisk them.",
    "Chop the vegetables finely.",
    "Heat oil in a pan, saut√© vegetables, then pour in eggs.",
    "Cook until set and fold the omelette in half."
  ],
  "prep_time": 8,
  "cook_time": 7,
  "meal_type": "breakfast",
  "creator_id": 1,
  "ingredients": [
    {
      "ingredient": {
        "id": 4,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Eggs",
        "category": "proteins",
        "allergens": [
          "egg"
        ],
        "dietary_info": [
          "high-protein",
          "gluten-free"
        ]
      },
      "quantity": 3,
      "unit": "pcs"
    },
    {
      "ingredient": {
        "id": 5,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Tofu",
        "category": "proteins",
        "allergens": [],
        "dietary_info": [
          "vegan",
          "soy-based"
        ]
      },
      "quantity": 0.5,
      "unit": "cup"
    },
    {
      "ingredient": {
        "id": 6,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Spinach",
        "category": "vegetables",
        "allergens": [],
        "dietary_info": [
          "vegan",
          "gluten-free"
        ]
      },
      "quantity": 1,
      "unit": "pcs"
    }
  ],
  "cost_per_serving": null,
  "difficulty_rating": null,
  "taste_rating": null,
  "health_rating": null,
  "like_count": 0,
  "comment_count": 0,
  "difficulty_rating_count": 0,
  "taste_rating_count": 0,
  "health_rating_count": 0,
  "is_approved": false,
  "is_featured": false,
  "created_at": "2025-05-04T22:24:17.814577Z",
  "updated_at": "2025-05-04T22:24:17.814642Z",
  "deleted_on": null,
  "total_time": 15,
  "total_user_ratings": 0,
  "total_ratings": 0,
  "alergens": [
    "egg"
  ],
  "dietary_info": [
    "high-protein",
    "gluten-free",
    "soy-based",
    "vegan"
  ]
}
```

### 2. **GET** `/recipes/`
- Retrieves a list of all recipes.
- Supports pagination with `page` and `page_size` query parameters.
- The response includes the total number of recipes and the current page of results.
- Useful for displaying a list of recipes in a UI.

#### üîç Request Format
```json
{
  "page": 1,
  "page_size": 3
}
```

- Optional:
  - `page`: The page number to retrieve (default is 1).
  - `page_size`: The number of items to return per page (default is 10).
  - **Note:** The `page` and `page_size` parameters are written to code easier, we will never use these parameters in the frontend. You can get the wanted id with only giving the name field.

#### üì¶ Response Format
```json
{
  "page": 1,
  "page_size": 3,
  "total": 6,
  "results": [
    {
      "id": 1,
      "name": "Pancakes",
      "meal_type": "breakfast",
      "creator_id": 1,
      "prep_time": 10,
      "cook_time": 15,
      "cost_per_serving": null,
      "difficulty_rating": null,
      "difficulty_rating_count": 0,
      "taste_rating": null,
      "taste_rating_count": 0,
      "health_rating": null,
      "health_rating_count": 0,
      "like_count": 0,
      "comment_count": 0,
      "is_approved": false,
      "is_featured": false,
      "total_time": 25
    },
    {
      "id": 4,
      "name": "Pancakes",
      "meal_type": "breakfast",
      "creator_id": 1,
      "prep_time": 10,
      "cook_time": 15,
      "cost_per_serving": null,
      "difficulty_rating": null,
      "difficulty_rating_count": 0,
      "taste_rating": null,
      "taste_rating_count": 0,
      "health_rating": null,
      "health_rating_count": 0,
      "like_count": 0,
      "comment_count": 0,
      "is_approved": false,
      "is_featured": false,
      "total_time": 25
    },
    {
      "id": 5,
      "name": "Pancakes",
      "meal_type": "breakfast",
      "creator_id": 1,
      "prep_time": 10,
      "cook_time": 15,
      "cost_per_serving": null,
      "difficulty_rating": null,
      "difficulty_rating_count": 0,
      "taste_rating": null,
      "taste_rating_count": 0,
      "health_rating": null,
      "health_rating_count": 0,
      "like_count": 0,
      "comment_count": 0,
      "is_approved": false,
      "is_featured": false,
      "total_time": 25
    }
  ]
}
```

### 3. **GET** `/recipes/{recipe_id}/`
- Retrieves detailed information about a specific recipe by its ID.
- The response includes the recipe's name, steps, preparation and cooking times, meal type, creator ID, and a list of associated ingredients.
- Useful for displaying detailed recipe information in a UI.

#### üîç Request Format
- Path variable:
  - "id": 12

- Must be provided:
  - `id`: The ID of the recipe to retrieve.


#### üì¶ Response Format
```json
{
  "id": 12,
  "name": "Veggie Omelette",
  "steps": [
    "Crack the eggs into a bowl and whisk them.",
    "Chop the vegetables finely.",
    "Heat oil in a pan, saut√© vegetables, then pour in eggs.",
    "Cook until set and fold the omelette in half."
  ],
  "prep_time": 8,
  "cook_time": 7,
  "meal_type": "breakfast",
  "creator_id": 1,
  "ingredients": [
    {
      "ingredient": {
        "id": 4,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Eggs",
        "category": "proteins",
        "allergens": [
          "egg"
        ],
        "dietary_info": [
          "high-protein",
          "gluten-free"
        ]
      },
      "quantity": 3,
      "unit": "pcs"
    },
    {
      "ingredient": {
        "id": 5,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Tofu",
        "category": "proteins",
        "allergens": [],
        "dietary_info": [
          "vegan",
          "soy-based"
        ]
      },
      "quantity": 0.5,
      "unit": "cup"
    },
    {
      "ingredient": {
        "id": 6,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Spinach",
        "category": "vegetables",
        "allergens": [],
        "dietary_info": [
          "vegan",
          "gluten-free"
        ]
      },
      "quantity": 1,
      "unit": "pcs"
    }
  ],
  "cost_per_serving": null,
  "difficulty_rating": null,
  "taste_rating": null,
  "health_rating": null,
  "like_count": 0,
  "comment_count": 0,
  "difficulty_rating_count": 0,
  "taste_rating_count": 0,
  "health_rating_count": 0,
  "is_approved": false,
  "is_featured": false,
  "created_at": "2025-05-04T22:24:17.814577Z",
  "updated_at": "2025-05-04T22:24:17.814642Z",
  "deleted_on": null,
  "total_time": 15,
  "total_user_ratings": 0,
  "total_ratings": 0,
  "alergens": [
    "egg"
  ],
  "dietary_info": [
    "high-protein",
    "gluten-free",
    "soy-based",
    "vegan"
  ]
}
```

### 4. **PUT** `/recipes/{recipe_id}/`
- Updates an existing recipe with the provided data.
- Requires the user to be authenticated (via Bearer token).
- The creator field is automatically assigned based on the logged-in user via Bearer token (JWT).

#### üîç Request Format
- Data:
```json
{
  "name": "New Veggies Omelette",
  "steps": [
    "Crack the eggs into a bowl and whisk them.",
    "Chop the vegetables finely."
  ],
  "prep_time": 12,
  "cook_time": 15,
  "meal_type": "dinner",
  "ingredients": [
    {
      "ingredient_id": 4,
      "quantity": 3,
      "unit": "pcs"
    }
  ]
}
```
- Path variable:
  - "id": 12

- Must be provided:
  - `id`: The ID of the recipe to retrieve.

- Optional:
  - `name`: The name of the recipe.
  - `steps`: The steps to prepare the recipe. (Reminder: The steps should be in a list format, not a string. And can be empty string if the user not sure about the steps for now.)
  - `prep_time`: Preparation time in minutes.
  - `cook_time`: Cooking time in minutes.
  - `meal_type`: Type of meal (e.g., breakfast, lunch, dinner).
  - `ingredients`: List of ingredients with their IDs, quantities, and units.
- **Note**: The `ingredients` field should contain a list of objects, each with `ingredient_id`, `quantity`, and `unit`.
- The `creator` field is automatically set based on the authenticated user.
- The `created_at`, `updated_at`, and `deleted_on` fields are managed by the database.

#### üì¶ Response Format
```json
{
  "id": 12,
  "name": "New Veggies Omelette",
  "steps": [
    "Crack the eggs into a bowl and whisk them.",
    "Chop the vegetables finely."
  ],
  "prep_time": 12,
  "cook_time": 15,
  "meal_type": "dinner",
  "creator_id": 1,
  "ingredients": [
    {
      "ingredient": {
        "id": 4,
        "created_at": "2025-05-05T00:21:45Z",
        "updated_at": "2025-05-05T00:21:45Z",
        "deleted_on": null,
        "name": "Eggs",
        "category": "proteins",
        "allergens": [
          "egg"
        ],
        "dietary_info": [
          "high-protein",
          "gluten-free"
        ]
      },
      "quantity": 3,
      "unit": "pcs"
    }
  ],
  "cost_per_serving": null,
  "difficulty_rating": null,
  "taste_rating": null,
  "health_rating": null,
  "like_count": 0,
  "comment_count": 0,
  "difficulty_rating_count": 0,
  "taste_rating_count": 0,
  "health_rating_count": 0,
  "is_approved": false,
  "is_featured": false,
  "created_at": "2025-05-04T22:24:17.814577Z",
  "updated_at": "2025-05-04T22:29:05.801015Z",
  "deleted_on": null,
  "total_time": 27,
  "total_user_ratings": 0,
  "total_ratings": 0,
  "alergens": [
    "egg"
  ],
  "dietary_info": [
    "high-protein",
    "gluten-free"
  ]
}
```


### 5. **DELETE** `/recipes/{recipe_id}/`
- Deletes a recipe by its ID.
- Requires the user to be authenticated (via Bearer token).
- The recipe is marked as deleted in the database (soft delete).

#### üîç Request Format
- Path variable:
  - "id": 12

- Must be provided:
  - `id`: The ID of the recipe to retrieve.

#### üì¶ Response Format
  - **Success**: Status code 204 No Content (Deleted the recipe and also recipe ingredients)
  - **Failure**: Status code 404 Not Found (Object was not created or already deleted)

## üìç Common Problems:
- **Missing Required Fields**: Ensure all required fields are included in the request body.
- **Invalid Token**: Ensure the Bearer token is valid and not expired. Otherwise you will get a 401 error (Error: Unauthorized).
```json
{
  "detail": "Authentication credentials were not provided."
}
```
  - If you don't know how to get the token, please refer to the `fithub/backend/docs/api_documentations/jwt_token/jwt.md` file.
- **Invalid Ingredient ID**: Ensure the ingredient IDs provided in the request exist in the database. We have only populated the db with some number of ingredients, for now up to 47.
- **Invalid Meal Type**: Ensure the meal type is one of the allowed values (breakfast, lunch, dinner).
- **Invalid Quantity or Unit**: Ensure the quantity is a positive number and the unit is a valid string. We don't have any enum for the unit.
