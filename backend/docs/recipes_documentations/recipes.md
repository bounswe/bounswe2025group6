# üìò Recipe API Documentation

This document describes how to use the Recipe API endpoint, which allows for creating new recipes and retrieving detailed recipe information, including associated ingredients.

## üìç Endpoints
### 1. **POST** `/recipes/`
- Creates a new recipe with the provided data.
- Requires the user to be authenticated (via Bearer token).
- The creator field is automatically assigned based on the logged-in user via Bearer token (JWT).

#### üîç Request Format
```json
{
  * "name": "Veggie Omelette",
  * "steps": [
    "Crack the eggs into a bowl and whisk them.",
    "Chop the vegetables finely.",
    "Heat oil in a pan, saut√© vegetables, then pour in eggs.",
    "Cook until set and fold the omelette in half."
  ],
  * "prep_time": 8,
  * "cook_time": 7,
  * "meal_type": "breakfast",
  * "ingredients": [
    {
      "ingredient_id": 4,
      "quantity": 3,
      "unit": "pcs"
    },
    {
      "ingredient_id": 5,
      "quantity": 0.5,
      "unit": "cup"
    },
    {
      "ingredient_id": 6,
      "quantity": 1,
      "unit": "pcs"
    }
  ]
}
```

- Must be provided:
  - `name`: The name of the recipe.
  - `steps`: The steps to prepare the recipe. (Rememinder: The steps should be in a list format, not a string. And can be empty string if the user not sure about the steps for now.)
  - `prep_time`: Preparation time in minutes.
  - `cook_time`: Cooking time in minutes.
  - `meal_type`: Type of meal (e.g., breakfast, lunch, dinner).
  - `ingredients`: List of ingredients with their IDs, quantities, and units.
- **Note**: The `ingredients` field should contain a list of objects, each with `ingredient_id`, `quantity`, and `unit`.
- The `creator` field is automatically set based on the authenticated user.
- The `id` field is automatically generated by the database.
- The `created_at`, `updated_at`, and `deleted_on` fields are managed by the database.
- The `deleted_on` field is set to `null` when the recipe is created.

#### üì¶ Response Format
```json
{
  "id": 26,
  "name": "Pancakes",
  "steps": [
    "Mix the flour, sugar, and baking powder.",
    "Add milk and eggs, stir well.",
    "Heat a pan and cook the pancakes until golden brown on both sides."
  ],
  "prep_time": 10,
  "cook_time": 15,
  "meal_type": "breakfast",
  "creator_id": 3,
  "ingredients": [
    {
      "ingredient": {
        "id": 1,
        "created_at": "2025-05-03T22:02:12Z",
        "updated_at": "2025-05-03T22:02:12Z",
        "deleted_on": null,
        "name": "Chicken Breast",
        "category": "proteins",
        "allergens": [],
        "dietary_info": [
          "high-protein"
        ]
      },
      "quantity": 1.5,
      "unit": "cups"
    },
    {
      "ingredient": {
        "id": 2,
        "created_at": "2025-05-03T22:02:12Z",
        "updated_at": "2025-05-03T22:02:12Z",
        "deleted_on": null,
        "name": "Salmon Fillet",
        "category": "proteins",
        "allergens": [
          "fish"
        ],
        "dietary_info": [
          "omega-3",
          "keto-friendly"
        ]
      },
      "quantity": 2,
      "unit": "pcs"
    },
    {
      "ingredient": {
        "id": 3,
        "created_at": "2025-05-03T22:02:12Z",
        "updated_at": "2025-05-03T22:02:12Z",
        "deleted_on": null,
        "name": "Ground Beef",
        "category": "proteins",
        "allergens": [],
        "dietary_info": [
          "high-protein"
        ]
      },
      "quantity": 1,
      "unit": "cup"
    }
  ],
  "cost_per_serving": null,
  "difficulty_rating": null,
  "taste_rating": null,
  "health_rating": null,
  "like_count": 0,
  "comment_count": 0,
  "difficulty_rating_count": 0,
  "taste_rating_count": 0,
  "health_rating_count": 0,
  "is_approved": false,
  "is_featured": false,
  "created_at": "2025-05-04T21:14:05.956932Z",
  "updated_at": "2025-05-04T21:14:05.956962Z",
  "deleted_on": null,
  "total_time": 25,
  "total_user_ratings": 0,
  "total_ratings": 0,
  "alergens": [
    "fish"
  ],
  "dietary_info": [
    "keto-friendly",
    "high-protein",
    "omega-3"
  ]
}
````

### 2. **GET** `/recipes/`
- Retrieves a list of all recipes.
- Supports pagination with `page` and `page_size` query parameters.
- The response includes the total number of recipes and the current page of results.
- Useful for displaying a list of recipes in a UI.

#### üîç Request Format
```json
{
  "page": 1,
  "page_size": 3
}
```

- Optional:
  - `page`: The page number to retrieve (default is 1).
  - `page_size`: The number of items to return per page (default is 10).
  - **Note:** The `page` and `page_size` parameters are written to code easier, we will never use these parameters in the frontend. You can get the wanted id with only giving the name field.

#### üì¶ Response Format
```json
{
  "page": 1,
  "page_size": 3,
  "total": 10,
  "results": [
    {
      "id": 15,
      "name": "Veggie Omelette",
      "meal_type": "breakfast",
      "creator_id": 3,
      "prep_time": 8,
      "cook_time": 7,
      "cost_per_serving": null,
      "difficulty_rating": null,
      "difficulty_rating_count": 0,
      "taste_rating": null,
      "taste_rating_count": 0,
      "health_rating": null,
      "health_rating_count": 0,
      "like_count": 0,
      "comment_count": 0,
      "is_approved": false,
      "is_featured": false,
      "total_time": 15
    },
    {
      "id": 16,
      "name": "Spaghetti Bolognese",
      "meal_type": "dinner",
      "creator_id": 3,
      "prep_time": 15,
      "cook_time": 45,
      "cost_per_serving": null,
      "difficulty_rating": null,
      "difficulty_rating_count": 0,
      "taste_rating": null,
      "taste_rating_count": 0,
      "health_rating": null,
      "health_rating_count": 0,
      "like_count": 0,
      "comment_count": 0,
      "is_approved": false,
      "is_featured": false,
      "total_time": 60
    },
    {
      "id": 17,
      "name": "Pancakes",
      "meal_type": "breakfast",
      "creator_id": 3,
      "prep_time": 10,
      "cook_time": 15,
      "cost_per_serving": null,
      "difficulty_rating": null,
      "difficulty_rating_count": 0,
      "taste_rating": null,
      "taste_rating_count": 0,
      "health_rating": null,
      "health_rating_count": 0,
      "like_count": 0,
      "comment_count": 0,
      "is_approved": false,
      "is_featured": false,
      "total_time": 25
    }
  ]
}
```

### 3. **GET** `/recipes/{recipe_id}/`
- Retrieves detailed information about a specific recipe by its ID.
- The response includes the recipe's name, steps, preparation and cooking times, meal type, creator ID, and a list of associated ingredients.
- Useful for displaying detailed recipe information in a UI.

#### üîç Request Format
```json
{
  * "recipe_id": 15
}
```

- Must be provided:
  - `recipe_id`: The ID of the recipe to retrieve.


#### üì¶ Response Format
```json
{
  "id": 26,
  "name": "Pancakes",
  "steps": [
    "Mix the flour, sugar, and baking powder.",
    "Add milk and eggs, stir well.",
    "Heat a pan and cook the pancakes until golden brown on both sides."
  ],
  "prep_time": 10,
  "cook_time": 15,
  "meal_type": "breakfast",
  "creator_id": 3,
  "ingredients": [
    {
      "ingredient": {
        "id": 1,
        "created_at": "2025-05-03T22:02:12Z",
        "updated_at": "2025-05-03T22:02:12Z",
        "deleted_on": null,
        "name": "Chicken Breast",
        "category": "proteins",
        "allergens": [],
        "dietary_info": [
          "high-protein"
        ]
      },
      "quantity": 1.5,
      "unit": "cups"
    },
    {
      "ingredient": {
        "id": 2,
        "created_at": "2025-05-03T22:02:12Z",
        "updated_at": "2025-05-03T22:02:12Z",
        "deleted_on": null,
        "name": "Salmon Fillet",
        "category": "proteins",
        "allergens": [
          "fish"
        ],
        "dietary_info": [
          "omega-3",
          "keto-friendly"
        ]
      },
      "quantity": 2,
      "unit": "pcs"
    },
    {
      "ingredient": {
        "id": 3,
        "created_at": "2025-05-03T22:02:12Z",
        "updated_at": "2025-05-03T22:02:12Z",
        "deleted_on": null,
        "name": "Ground Beef",
        "category": "proteins",
        "allergens": [],
        "dietary_info": [
          "high-protein"
        ]
      },
      "quantity": 1,
      "unit": "cup"
    }
  ],
  "cost_per_serving": null,
  "difficulty_rating": null,
  "taste_rating": null,
  "health_rating": null,
  "like_count": 0,
  "comment_count": 0,
  "difficulty_rating_count": 0,
  "taste_rating_count": 0,
  "health_rating_count": 0,
  "is_approved": false,
  "is_featured": false,
  "created_at": "2025-05-04T21:14:05.956932Z",
  "updated_at": "2025-05-04T21:14:05.956962Z",
  "deleted_on": null,
  "total_time": 25,
  "total_user_ratings": 0,
  "total_ratings": 0,
  "alergens": [
    "fish"
  ],
  "dietary_info": [
    "keto-friendly",
    "high-protein",
    "omega-3"
  ]
}
```

#### üìç Common Problems:
- **Missing Required Fields**: Ensure all required fields are included in the request body.
- **Invalid Token**: Ensure the Bearer token is valid and not expired. Otherwise you will get a 401 error (Error: Unauthorized).
```json
{
  "detail": "Authentication credentials were not provided."
}
```
  - If you don't know how to get the token, please refer to the `fithub/backend/docs/api_documentations/jwt_token/jwt.md` file.
- **Invalid Ingredient ID**: Ensure the ingredient IDs provided in the request exist in the database. We have only populated the db with some number of ingredients, for now up to 47.
- **Invalid Meal Type**: Ensure the meal type is one of the allowed values (breakfast, lunch, dinner).
- **Invalid Quantity or Unit**: Ensure the quantity is a positive number and the unit is a valid string. We don't have any enum for the unit.
